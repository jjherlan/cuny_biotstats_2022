<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="jsg" />


<title>2022 Spring 78002 final answers</title>

<script src="site_libs/header-attrs-2.18/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>









<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">My Website</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
<li>
  <a href="about.html">About</a>
</li>
<li>
  <a href="ex3_introduction_to_hypothesis_testing_via_binomial_test.html">Lesson 3</a>
</li>
<li>
  <a href="ex6_continuous_tests_for_two_populations.html">Lesson 6</a>
</li>
<li>
  <a href="2022_spring_final_78002.html">Spring 2022 Final</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">



<h1 class="title toc-ignore">2022 Spring 78002 final answers</h1>
<h4 class="author">jsg</h4>
<h4 class="date">Last compiled on 11 December, 2022 17:13</h4>

</div>


<div id="instructions-read-this-first." class="section level1">
<h1>Instructions! Read this first.</h1>
<p>The exam is open note, open course website, open class-related code
repositories (mine and those you produced in class). However, you may
not get external help ( from other students, directed internet searches,
etc.). Please update the statement below to acknowledge these
instructions (and that you can use git).</p>
<p>I, INSERT YOUR NAME HERE, promise to not seek external help on the
exam. I understand any academic issues will result in a D or F on the
exam or in the class and be reported to the Dean of Students.</p>
<p>The exam is due by 12 PM on Monday, 5/16/2022.</p>
<p>As often happens, your excellent statistical advice (provided via the
78001 exam) has led to more calls for help (or just being given the data
to anlayze). The below questions build on the earlier exam.</p>
</div>
<div id="fear-effects" class="section level1">
<h1>Fear effects</h1>
<p>Following your advice, your colleague asked you to help analye the
data. As a reminder:</p>
<p>Prey (tadpoles) were housed in tanks (20 per tank). Prey in each tank
were exposed to one of two treatments. Predator treatment tanks also
housed a dragonfly naiad (a major predator of tadpoles) in a small
cylinder with mesh (so water was shared but the predator could not
consume the tadpoles). No predator treatment tanks housed an empty
cylinder. The colleague measured the <strong>length of each
tadpole</strong> and the <strong>number of dead tadpoles</strong> in
each tank.</p>
<div id="section" class="section level2">
<h2>1.</h2>
<p>Your colleagues tadpole length data is found below. Help them analyze
the data.</p>
<div id="data-creation-for-example" class="section level3">
<h3>Data creation for example</h3>
<pre class="r"><code>fear &lt;- data.frame(treatment = c(rep(&quot;predator&quot;, 80), rep(&quot;no_predator&quot;,80)),
                   container = rep(letters[1:8],each=20))
fear$length &lt;- c(rnorm(80,2,1),rnorm(80,0,1))+25 +
 c(rnorm(20,runif(1), 1),rnorm(20,runif(1), 1),
   rnorm(20,runif(1), 1),rnorm(20,runif(1), 1),
   rnorm(20,runif(1), 1),rnorm(20,runif(1), 1),
    rnorm(20,runif(1), 1),rnorm(20,runif(1), 1))
write.csv(fear, &quot;fear_final.csv&quot;, row.names = F)</code></pre>
<pre class="r"><code>fear &lt;- read.csv(&quot;https://docs.google.com/spreadsheets/d/e/2PACX-1vSybsT7VO2rv24Rhi_WD5MBB3ww5RKXnqM2BveSP848vnldhPeFigBWPjxcY_WpvB1f1cd1PKQe1v3v/pub?gid=1960907558&amp;single=true&amp;output=csv&quot;,
                 stringsAsFactors = T)</code></pre>
<ul>
<li><p><strong>Question</strong>:</p></li>
<li><p><span class="math inline">\(H_{0}\)</span> Treatment did not
impact tadpole length.</p></li>
<li><p><span class="math inline">\(H_{A}\)</span> Treatment did impact
tadpole length.</p></li>
</ul>
<p>Make sure you include</p>
<ul>
<li><p>explanation for test you will use</p>
<ul>
<li><em>I will use a linear mixed-effects model. The response (length)
is continuous, the explanatory variable (treatment) is categorical, and
I need to add a random effect to account for the fact tadpoles within
each tank are not fully independent.</em></li>
</ul></li>
<li><p>results from statistical test</p></li>
</ul>
<pre class="r"><code>library(lme4)</code></pre>
<pre><code>## Warning: package &#39;lme4&#39; was built under R version 4.2.2</code></pre>
<pre><code>## Loading required package: Matrix</code></pre>
<pre class="r"><code>fear_lmer &lt;- lmer(length~treatment + (1|container), fear)
check_mixed_model &lt;- function (model, model_name = NULL) {
  #collection of things you might check for mixed model
  par(mfrow = c(2,3))
  #not sure what this does with mutliple random effects, so stop with 1 for now
  if(length(names(ranef(model))&lt;2)){
    qqnorm(ranef(model, drop = T)[[1]], pch = 19, las = 1, cex = 1.4, main= paste(model_name, 
                                                                                  &quot;\n Random effects Q-Q plot&quot;))
  }
  plot(fitted(model),residuals(model), main = paste(model_name, 
                                                    &quot;\n residuals vs fitted&quot;))
  qqnorm(residuals(model), main =paste(model_name, 
                                       &quot;\nresiduals q-q plot&quot;))
  qqline(residuals(model))
  hist(residuals(model), main = paste(model_name, 
                                      &quot;\nresidual histogram&quot;))
}
check_mixed_model(fear_lmer)
summary(fear_lmer)</code></pre>
<pre><code>## Linear mixed model fit by REML [&#39;lmerMod&#39;]
## Formula: length ~ treatment + (1 | container)
##    Data: fear
## 
## REML criterion at convergence: 577.3
## 
## Scaled residuals: 
##      Min       1Q   Median       3Q      Max 
## -2.48507 -0.63990  0.02658  0.66612  3.07443 
## 
## Random effects:
##  Groups    Name        Variance Std.Dev.
##  container (Intercept) 0.08655  0.2942  
##  Residual              2.09104  1.4460  
## Number of obs: 160, groups:  container, 8
## 
## Fixed effects:
##                   Estimate Std. Error t value
## (Intercept)        25.7692     0.2186 117.897
## treatmentpredator   2.0236     0.3091   6.546
## 
## Correlation of Fixed Effects:
##             (Intr)
## trtmntprdtr -0.707</code></pre>
<pre class="r"><code>library(car)</code></pre>
<pre><code>## Warning: package &#39;car&#39; was built under R version 4.2.2</code></pre>
<pre><code>## Loading required package: carData</code></pre>
<pre class="r"><code>Anova(fear_lmer, type = &quot;III&quot;)</code></pre>
<pre><code>## Analysis of Deviance Table (Type III Wald chisquare tests)
## 
## Response: length
##                 Chisq Df Pr(&gt;Chisq)    
## (Intercept) 13899.645  1  &lt; 2.2e-16 ***
## treatment      42.855  1  5.895e-11 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p><img
src="2022_spring_final_78002_files/figure-html/unnamed-chunk-3-1.png" /><!-- --></p>
<ul>
<li>clear explanation of how results relate to your stated
hypotheses</li>
</ul>
<p>Assumptions appear to be met. We note a significant impact of
treatment using likelihood (<span
class="math inline">\(\chi^2\)</span>)-based tests (<span
class="math inline">\(\chi^2_1\)</span> = 42.86, p &lt; 0.01). Analysis
indicates tadpoles actually grew more in the predator treatment.</p>
</div>
</div>
<div id="section-1" class="section level2">
<h2>2.</h2>
<p>Create a properly-labelled plot of the data. There are many options
here, but make sure you show trends and patterns that match your
analysis.</p>
<pre class="r"><code>library(Rmisc)</code></pre>
<pre><code>## Loading required package: lattice</code></pre>
<pre><code>## Loading required package: plyr</code></pre>
<pre><code>## Warning: package &#39;plyr&#39; was built under R version 4.2.2</code></pre>
<pre class="r"><code>fear_graph &lt;- summarySE(fear, measurevar = &quot;length&quot;, groupvars = &quot;treatment&quot;)
levels(fear_graph$treatment) = c(&quot;Control&quot; , &quot;Predator&quot;)

library(ggplot2)</code></pre>
<pre><code>## Warning: package &#39;ggplot2&#39; was built under R version 4.2.2</code></pre>
<pre class="r"><code>ggplot(fear_graph, 
                                     aes_string(x=&quot;treatment&quot;, 
                                                y = &quot;length&quot;, color = &quot;treatment&quot;,
                                                shape = &quot;treatment&quot;)) +
  geom_point(size = 2) + 
  geom_errorbar(aes(ymin = length - ci, 
                    ymax = length + ci), size = 1,
                width = .75)+
  xlab(&quot;Treatment&quot;)+
  ylab(&quot;length (mm)&quot;)+
  theme(axis.title.x = element_text(face=&quot;bold&quot;, size=15), 
        axis.title.y = element_text(face=&quot;bold&quot;, size=15), 
        axis.text.y  = element_text(size=10),
        axis.text.x  = element_text(size=10), 
        legend.text =element_text(size=10),
        legend.title = element_text(size=10, face=&quot;bold&quot;),
        plot.title = element_text(hjust = 0.5, face=&quot;bold&quot;, size=20))+
  ylim(c(0,30))+
  guides(shape=&quot;none&quot;, color= &quot;none&quot;)+
  ggtitle(&quot;Tadpoles grow more in presence of predator&quot;)</code></pre>
<pre><code>## Warning: `aes_string()` was deprecated in ggplot2
## 3.0.0.
## ℹ Please use tidy evaluation ideoms with
##   `aes()`</code></pre>
<pre><code>## Warning: Using `size` aesthetic for lines was
## deprecated in ggplot2 3.4.0.
## ℹ Please use `linewidth` instead.</code></pre>
<p><img
src="2022_spring_final_78002_files/figure-html/unnamed-chunk-4-1.png" /><!-- --></p>
</div>
<div id="section-2" class="section level2">
<h2>3.</h2>
<p>Your colleague provided you the data on tadpole mortality too.</p>
<div id="data-creation" class="section level3">
<h3>Data creation</h3>
<pre class="r"><code>fear_mortality &lt;- data.frame(treatment = c(rep(&quot;predator&quot;, 4), rep(&quot;no_predator&quot;,4)),
                   container = letters[1:8], 
                   dead = c(rbinom(4, 20, .7), rbinom(4, 20, .5)))
write.csv(fear_mortality, &quot;fear_mortality.csv&quot;, row.names = F)</code></pre>
<pre class="r"><code>fear_mortality &lt;- read.csv(&quot;https://docs.google.com/spreadsheets/d/e/2PACX-1vQHLgiC6o2ezJPbEEcaU4Cb7Mz7F1-NMc8t5gMyEIMbLiPSDzslclIgRD51GefIBEl9gH7Fpylfbws5/pub?gid=2111555168&amp;single=true&amp;output=csv&quot;, stringsAsFactors = T)</code></pre>
<p>Help them analyze the data. Make sure you include</p>
<ul>
<li>null hypothesis
<ul>
<li><em>H<sub>0</sub>: Treatment did not impact tadpole
mortality</em></li>
</ul></li>
<li>alternative hypothesis
<ul>
<li><em>H<sub>A</sub>: Treatment did impact tadpole mortality</em></li>
</ul></li>
<li>explanation for test you will use
<ul>
<li><em>I will use a generalized linear model. The response (mortality
per tank) consists of success and failures, so I will use a model
utilizing a b binomial response. The explanatory variable (treatment) is
categorical. I do not need to add a random effect since the data is
taken at tank-level</em></li>
</ul></li>
<li>results from statistical test</li>
</ul>
<pre class="r"><code>fear_mortality</code></pre>
<pre><code>##     treatment container dead
## 1    predator         a   13
## 2    predator         b   10
## 3    predator         c   14
## 4    predator         d   13
## 5 no_predator         e   13
## 6 no_predator         f    6
## 7 no_predator         g   10
## 8 no_predator         h    7</code></pre>
<pre class="r"><code>mortality_glm &lt;- glm(cbind(dead, 20-dead)~treatment, fear_mortality, 
                     family = &quot;binomial&quot;)
plot(mortality_glm)</code></pre>
<p><img
src="2022_spring_final_78002_files/figure-html/unnamed-chunk-7-1.png" /><!-- --><img
src="2022_spring_final_78002_files/figure-html/unnamed-chunk-7-2.png" /><!-- --><img
src="2022_spring_final_78002_files/figure-html/unnamed-chunk-7-3.png" /><!-- --><img
src="2022_spring_final_78002_files/figure-html/unnamed-chunk-7-4.png" /><!-- --></p>
<pre class="r"><code>summary(mortality_glm)</code></pre>
<pre><code>## 
## Call:
## glm(formula = cbind(dead, 20 - dead) ~ treatment, family = &quot;binomial&quot;, 
##     data = fear_mortality)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -1.3737  -0.9653   0.2320   0.5122   1.7981  
## 
## Coefficients:
##                   Estimate Std. Error z value Pr(&gt;|z|)  
## (Intercept)        -0.2007     0.2247  -0.893   0.3719  
## treatmentpredator   0.7115     0.3222   2.208   0.0272 *
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 12.9939  on 7  degrees of freedom
## Residual deviance:  8.0399  on 6  degrees of freedom
## AIC: 39.118
## 
## Number of Fisher Scoring iterations: 3</code></pre>
<pre class="r"><code>Anova(mortality_glm, type= &quot;III&quot;)</code></pre>
<pre><code>## Analysis of Deviance Table (Type III tests)
## 
## Response: cbind(dead, 20 - dead)
##           LR Chisq Df Pr(&gt;Chisq)  
## treatment   4.9539  1    0.02603 *
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<ul>
<li>clear explanation of how results relate to your stated hypotheses
<ul>
<li>*The model appears to fit the data appropriately (residual deviance
divided by df is ~ 1). Results indicate a significant impact of
treatment on mortality (<span class="math inline">\(\chi^2_1\)</span> =
4.95, p = 02). Results indicate that tadpoles are more likely to die in
predator treatments.</li>
</ul></li>
</ul>
</div>
</div>
<div id="section-3" class="section level2">
<h2>4.</h2>
<p>You are also given data from the followup study where length and
width were analyzed in response to fear. The setup was the same (4 tanks
for each treatment, 20 tadpoles per tank), but this time they recorded
length and width of each tadpole. However, <strong>they realized at the
end of their work they were dealing with a cryptic species!</strong>,
meaning half the tadpoles belong to species A and half to species B.
They are not sure if this matters.</p>
<p>Data is shared below. Help them analyze it.</p>
<div id="data-creation-1" class="section level3">
<h3>Data creation</h3>
<pre class="r"><code>fear_lw &lt;- data.frame(treatment = c(rep(&quot;predator&quot;, 80), rep(&quot;no_predator&quot;,80)),
                   container = rep(letters[1:8],each=20))
fear_lw$length &lt;- c(rnorm(80,2,1),rnorm(80,0,1))+25 +
 c(rnorm(20,runif(1), 1),rnorm(20,runif(1), 1),
   rnorm(20,runif(1), 1),rnorm(20,runif(1), 1),
   rnorm(20,runif(1), 1),rnorm(20,runif(1), 1),
    rnorm(20,runif(1), 1),rnorm(20,runif(1), 1))
fear_lw$width &lt;- fear_lw$length*.1 +
 c(rnorm(20,runif(1), 1),rnorm(20,runif(1), 1),
   rnorm(20,runif(1), 1),rnorm(20,runif(1), 1),
   rnorm(20,runif(1), 1),rnorm(20,runif(1), 1),
    rnorm(20,runif(1), 1),rnorm(20,runif(1), 1))
fear_lw$species &lt;- factor(sample(c(&quot;A&quot;, &quot;B&quot;), nrow(fear_lw), prob = c(0.5, 0.5), replace = TRUE))
write.csv(fear_lw, &quot;fear_length_width.csv&quot;, row.names = F)</code></pre>
<pre class="r"><code>fear_lw &lt;- read.csv(&quot;https://docs.google.com/spreadsheets/d/e/2PACX-1vSataGluosvnurZ4qOn_UTyHod85nbPTC-V9g5FkMZjKO6CEeRCn6CTAClrMf3Suxo_3kM8k-N2AQVD/pub?gid=1237391888&amp;single=true&amp;output=csv&quot;,
                    stringsAsFactors = T)</code></pre>
<p>*Several options exist here (as is not uncommon for multivariate
analysis).</p>
</div>
<div id="use-a-manova" class="section level3">
<h3>Use a manova</h3>
<ul>
<li>null hypothesis
<ul>
<li><em>H<sub>0</sub>: There is no impact of treatment on mean
outcome</em></li>
<li><em>H<sub>0</sub>: There is no impact of species on mean
outcome</em></li>
<li><em>H<sub>0</sub>: There is no interaction between species and
treatment on mean outcome</em></li>
</ul></li>
<li>alternative hypothesis
<ul>
<li><em>H<sub>A</sub>: There is an impact of treatment on mean
outcome</em></li>
<li><em>H<sub>A</sub>: There is an impact of species on mean
outcome</em></li>
<li><em>H<sub>A</sub>: There is an interaction between species and
treatment on mean outcome</em></li>
</ul></li>
<li>explanation for test you will use
<ul>
<li><em>I will use a MANOVA to consider if the means for each variable
are impacted by treatment and species while noting potential (and
likely) correlation among these outcomes. Note</em></li>
</ul></li>
</ul>
<pre class="r"><code>cor.test(fear_lw$length, fear_lw$width)</code></pre>
<pre><code>## 
##  Pearson&#39;s product-moment correlation
## 
## data:  fear_lw$length and fear_lw$width
## t = 1.6676, df = 158, p-value = 0.09738
## alternative hypothesis: true correlation is not equal to 0
## 95 percent confidence interval:
##  -0.02413708  0.28094019
## sample estimates:
##       cor 
## 0.1315142</code></pre>
<p><em>This suggests the outcomes are related. Note for a MANOVA we
could not include random effects as presented in class, so I added as a
blocking factor</em></p>
<pre class="r"><code>  fear_manova &lt;- manova(cbind(length, width)~species*treatment+container, fear_lw)
summary(fear_manova)</code></pre>
<pre><code>##                    Df  Pillai approx F num Df den Df  Pr(&gt;F)    
## species             1 0.00580    0.434      2    149 0.64852    
## treatment           1 0.41314   52.447      2    149 &lt; 2e-16 ***
## container           6 0.14387    1.938     12    300 0.02978 *  
## species:treatment   1 0.00350    0.261      2    149 0.77038    
## Residuals         150                                           
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>No interaction, so drop</p>
<pre class="r"><code>  fear_manova &lt;- manova(cbind(length, width)~species+treatment+container, fear_lw)
summary(fear_manova)</code></pre>
<pre><code>##            Df  Pillai approx F num Df den Df  Pr(&gt;F)    
## species     1 0.00580    0.437      2    150 0.64668    
## treatment   1 0.41314   52.799      2    150 &lt; 2e-16 ***
## container   6 0.14355    1.946     12    302 0.02893 *  
## Residuals 151                                           
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<pre class="r"><code>summary.aov(fear_manova)</code></pre>
<pre><code>##  Response length :
##              Df Sum Sq Mean Sq F value Pr(&gt;F)    
## species       1   1.87   1.871  0.8797 0.3498    
## treatment     1 208.93 208.927 98.2256 &lt;2e-16 ***
## container     6   7.30   1.217  0.5722 0.7520    
## Residuals   151 321.18   2.127                   
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
##  Response width :
##              Df  Sum Sq Mean Sq F value  Pr(&gt;F)   
## species       1   0.033 0.03254  0.0374 0.84696   
## treatment     1   0.210 0.21020  0.2414 0.62388   
## container     6  16.108 2.68460  3.0837 0.00708 **
## Residuals   151 131.457 0.87057                   
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<ul>
<li>results from statistical test
<ul>
<li>*Results indicate treatment impacts length but not width (this is
likely due to the noise from each container (look at data
creation)).</li>
</ul></li>
</ul>
</div>
<div id="using-mixed-models" class="section level3">
<h3>Using mixed models</h3>
<p>Another option is to code the outcome (length/width) into a mixed
model framework using dummy variables (not shown in class) or ignore
relationships and do mixed model for each that includes species, eg</p>
<pre class="r"><code>fear_lmer_l &lt;- lmer(length~treatment*species + (1|container), fear_lw)</code></pre>
<pre><code>## boundary (singular) fit: see help(&#39;isSingular&#39;)</code></pre>
<pre class="r"><code>check_mixed_model(fear_lmer_l)
Anova(fear_lmer_l, type = &quot;III&quot;)</code></pre>
<pre><code>## Analysis of Deviance Table (Type III Wald chisquare tests)
## 
## Response: length
##                        Chisq Df Pr(&gt;Chisq)    
## (Intercept)       13158.7017  1  &lt; 2.2e-16 ***
## treatment            49.0898  1  2.445e-12 ***
## species               0.0203  1     0.8866    
## treatment:species     0.0135  1     0.9075    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<pre class="r"><code>fear_lmer_l &lt;- lmer(length~treatment+species + (1|container), fear_lw)</code></pre>
<pre><code>## boundary (singular) fit: see help(&#39;isSingular&#39;)</code></pre>
<pre class="r"><code>check_mixed_model(fear_lmer_l)</code></pre>
<p><img
src="2022_spring_final_78002_files/figure-html/unnamed-chunk-14-1.png" /><!-- --></p>
<pre class="r"><code>Anova(fear_lmer_l, type = &quot;III&quot;)</code></pre>
<pre><code>## Analysis of Deviance Table (Type III Wald chisquare tests)
## 
## Response: length
##                  Chisq Df Pr(&gt;Chisq)    
## (Intercept) 17216.5815  1     &lt;2e-16 ***
## treatment      99.8582  1     &lt;2e-16 ***
## species         0.1019  1     0.7496    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p><img
src="2022_spring_final_78002_files/figure-html/unnamed-chunk-14-2.png" /><!-- --></p>
<pre class="r"><code>fear_lmer_w &lt;- lmer(width~treatment*species + (1|container), fear_lw)
check_mixed_model(fear_lmer_l)
Anova(fear_lmer_l,type = &quot;III&quot;)</code></pre>
<pre><code>## Analysis of Deviance Table (Type III Wald chisquare tests)
## 
## Response: length
##                  Chisq Df Pr(&gt;Chisq)    
## (Intercept) 17216.5815  1     &lt;2e-16 ***
## treatment      99.8582  1     &lt;2e-16 ***
## species         0.1019  1     0.7496    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<pre class="r"><code>fear_lmer_l &lt;- lmer(width~treatment+species + (1|container), fear_lw)
check_mixed_model(fear_lmer_l)</code></pre>
<p><img
src="2022_spring_final_78002_files/figure-html/unnamed-chunk-15-1.png" /><!-- --></p>
<pre class="r"><code>Anova(fear_lmer_l, type = &quot;III&quot;)</code></pre>
<pre><code>## Analysis of Deviance Table (Type III Wald chisquare tests)
## 
## Response: width
##                Chisq Df Pr(&gt;Chisq)    
## (Intercept) 241.8374  1     &lt;2e-16 ***
## treatment     0.0803  1     0.7768    
## species       0.1027  1     0.7486    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p><img
src="2022_spring_final_78002_files/figure-html/unnamed-chunk-15-2.png" /><!-- --></p>
</div>
</div>
</div>
<div id="recruits" class="section level1">
<h1>Recruits</h1>
<div id="section-4" class="section level2">
<h2>5.</h2>
<p>The data on recruits is found below. As a reminder:</p>
<p>The paper focused on predicting the number of new deer (fawns,
density per km^2) produced at a nature reserve each season. Potential
covariates include adult abundance the previous season (density per
km^2), rain the previous year (inches), and winter harshness ( ranked
1-5, least to most severe) were monitored over 8 years.</p>
<pre class="r"><code>recruits &lt;- read.csv(&quot;https://docs.google.com/spreadsheets/d/e/2PACX-1vT4tICnyqUNSfWo4P3cMQ2DWxqe602IzdodBu5xoPKq43x5-u6vGpSDB_eXTvjFbHKQWwHHK9tkiJdL/pub?gid=1345393421&amp;single=true&amp;output=csv&quot;,
                     stringsAsFactors = T)</code></pre>
<p>Analyze the data. Make sure you include</p>
<ul>
<li>null hypothesis</li>
<li>alternative hypothesis</li>
<li>explanation for test you will use</li>
<li>results from statistical test</li>
<li>clear explanation of how results relate to your stated
hypotheses</li>
</ul>
<p>A few options exist here. If we consider this as a chance for
multiple regression, we want to identify best subset of variables for
explaining recruits. We can do this using bottom
up/top-down/nested/other approaches. A few are shown below.</p>
<div id="dredge-using-aic" class="section level3">
<h3>Dredge using AIC</h3>
<pre class="r"><code>library(MuMIn)</code></pre>
<pre><code>## Warning: package &#39;MuMIn&#39; was built under R version 4.2.2</code></pre>
<pre class="r"><code>recruits_lm &lt;- lm(recruits ~., recruits)
options(na.action = &quot;na.fail&quot;)
write.csv(dredge(recruits_lm), &quot;dredge_output.csv&quot;, row.names = F)</code></pre>
<pre><code>## Fixed term is &quot;(Intercept)&quot;</code></pre>
<pre><code>## Warning in !is.null(modif) &amp;&amp; modif %in% type2colname(column.types,
## protectedcoltypes): &#39;length(x) = 9 &gt; 1&#39; in coercion to &#39;logical(1)&#39;</code></pre>
<p>Results indicate adult alone best explains recruits. WE can check
this model</p>
<pre class="r"><code>adults_only &lt;- lm(recruits ~ adults, recruits)
plot(adults_only)</code></pre>
<p><img
src="2022_spring_final_78002_files/figure-html/unnamed-chunk-18-1.png" /><!-- --><img
src="2022_spring_final_78002_files/figure-html/unnamed-chunk-18-2.png" /><!-- --><img
src="2022_spring_final_78002_files/figure-html/unnamed-chunk-18-3.png" /><!-- --><img
src="2022_spring_final_78002_files/figure-html/unnamed-chunk-18-4.png" /><!-- --></p>
<pre class="r"><code>summary(adults_only)</code></pre>
<pre><code>## 
## Call:
## lm(formula = recruits ~ adults, data = recruits)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -0.24988 -0.17586  0.04938  0.12611  0.25309 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) -1.67914    0.63422  -2.648 0.038152 *  
## adults       0.49753    0.07453   6.676 0.000547 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.2121 on 6 degrees of freedom
## Multiple R-squared:  0.8813, Adjusted R-squared:  0.8616 
## F-statistic: 44.56 on 1 and 6 DF,  p-value: 0.0005471</code></pre>
<p>Obviously some fit issues with aassumptions, but given low sample
size there are only so many options here. Note scale of residuals are
very small to compared to outcomes.</p>
</div>
</div>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
