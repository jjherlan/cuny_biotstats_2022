<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="jsg" />


<title>11. Linear model extensions</title>

<script src="site_libs/header-attrs-2.18/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>









<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">My Website</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
<li>
  <a href="about.html">About</a>
</li>
<li>
  <a href="ex3_introduction_to_hypothesis_testing_via_binomial_test.html">Lesson 3</a>
</li>
<li>
  <a href="ex6_continuous_tests_for_two_populations.html">Lesson 6</a>
</li>
<li>
  <a href="10_ANCOVA_and_multiple_regression.html">Lesson 10</a>
</li>
<li>
  <a href="11_LM_Extensions.html">Lesson 11</a>
</li>
<li>
  <a href="12_Bayes_standalone.html">Lesson 12</a>
</li>
<li>
  <a href="13_Multivariate_methods.html">Lesson 13</a>
</li>
<li>
  <a href="2022_spring_final_78002.html">Spring 2022 Final</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">



<h1 class="title toc-ignore">11. Linear model extensions</h1>
<h4 class="author">jsg</h4>
<h4 class="date">Last compiled on 11 December, 2022 17:39</h4>

</div>


<pre class="r"><code>require(tidyverse)
require(lme4)</code></pre>
<pre><code>## Loading required package: lme4</code></pre>
<pre><code>## Warning: package &#39;lme4&#39; was built under R version 4.2.2</code></pre>
<pre><code>## Loading required package: Matrix</code></pre>
<pre><code>## 
## Attaching package: &#39;Matrix&#39;</code></pre>
<pre><code>## The following objects are masked from &#39;package:tidyr&#39;:
## 
##     expand, pack, unpack</code></pre>
<pre class="r"><code>require(car)
require(multcomp)</code></pre>
<pre><code>## Loading required package: multcomp</code></pre>
<pre><code>## Loading required package: mvtnorm</code></pre>
<pre><code>## Loading required package: survival</code></pre>
<pre><code>## Loading required package: TH.data</code></pre>
<pre><code>## 
## Attaching package: &#39;TH.data&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:MASS&#39;:
## 
##     geyser</code></pre>
<pre class="r"><code>require(Rmisc)</code></pre>
<pre><code>## Loading required package: Rmisc</code></pre>
<pre><code>## Loading required package: lattice</code></pre>
<pre><code>## Loading required package: plyr</code></pre>
<pre><code>## Warning: package &#39;plyr&#39; was built under R version 4.2.2</code></pre>
<pre><code>## ------------------------------------------------------------------------------</code></pre>
<pre><code>## You have loaded plyr after dplyr - this is likely to cause problems.
## If you need functions from both plyr and dplyr, please load plyr first, then dplyr:
## library(plyr); library(dplyr)</code></pre>
<pre><code>## ------------------------------------------------------------------------------</code></pre>
<pre><code>## 
## Attaching package: &#39;plyr&#39;</code></pre>
<pre><code>## The following objects are masked from &#39;package:dplyr&#39;:
## 
##     arrange, count, desc, failwith, id, mutate, rename, summarise,
##     summarize</code></pre>
<pre><code>## The following object is masked from &#39;package:purrr&#39;:
## 
##     compact</code></pre>
<pre class="r"><code>library(MuMIn)
require(mgcv)</code></pre>
<pre><code>## Loading required package: mgcv</code></pre>
<pre><code>## Warning: package &#39;mgcv&#39; was built under R version 4.2.2</code></pre>
<pre><code>## Loading required package: nlme</code></pre>
<pre><code>## 
## Attaching package: &#39;nlme&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:lme4&#39;:
## 
##     lmList</code></pre>
<pre><code>## The following object is masked from &#39;package:dplyr&#39;:
## 
##     collapse</code></pre>
<pre><code>## This is mgcv 1.8-41. For overview type &#39;help(&quot;mgcv-package&quot;)&#39;.</code></pre>
<p>Before doing this, review the ** Linear Model Extensions** lecture
set slides from <a
href="https://sites.google.com/view/biostats/lessons/linear-model-extensions"
class="uri">https://sites.google.com/view/biostats/lessons/linear-model-extensions</a>
and the <strong>11_Mixed_models_and_other_extensions.R</strong> script
in the lecture files folder of the <a
href="https://github.com/jsgosnell/CUNY-BioStats">CUNY-BioStats github
repository</a>. Make sure you are comfortable with null and alternative
hypotheses and appropriate plots for all examples.</p>
<p>Remember you should</p>
<ul>
<li>add code chunks by clicking the <em>Insert Chunk</em> button on the
toolbar or by pressing <em>Ctrl+Alt+I</em> to answer the questions!</li>
<li><strong>knit</strong> your file to produce a markdown version that
you can see!</li>
<li>save your work often
<ul>
<li><strong>commit</strong> it via git!</li>
<li><strong>push</strong> updates to github</li>
</ul></li>
</ul>
<ol style="list-style-type: decimal">
<li>In a study considering how the presence of sea stars changed snail
growth patterns, ~25 snails were grown in containers containing 0,1, or
2 seastars.<br />
Since non-consumptive effects are often threshold based, these
treatments levels should be considered as groups (not as a continuous
variable!). The data is available at</li>
</ol>
<p><a
href="https://raw.githubusercontent.com/jsgosnell/CUNY-BioStats/master/datasets/snail_modified_for_class.csv"
class="uri">https://raw.githubusercontent.com/jsgosnell/CUNY-BioStats/master/datasets/snail_modified_for_class.csv</a></p>
<p>FL is the final length of measured snails, and the treatment (coded
1-3) correspond to [1=Control (no predators). 2=1 predator treatment,3=2
predator treatment).</p>
<p>What method would you use to analyze this data and why? Carry out
your test, stating your null hypothesis, test assumptions, p-value, and
interpretation.<br />
Describe any necessary steps and provide graphics and values as needed.
If needed, can you determine which treatments differ from each
other?</p>
<pre class="r"><code>snail &lt;- read.csv(file = &quot;snail_modified_for_class.csv&quot;) %&gt;%
as_tibble() %&gt;%
  mutate_at(vars(Treatment), factor) %&gt;%
    mutate(treat = case_when(
    Treatment == &quot;1&quot; ~ &quot;Control&quot;, 
    Treatment == &quot;2&quot; ~ &quot;Single predator&quot;,
    Treatment == &quot;3&quot; ~ &quot;Two predators&quot;
  )
    ) %&gt;%
    mutate_at(vars(treat), factor)</code></pre>
<pre class="r"><code>snail</code></pre>
<pre><code>## # A tibble: 234 × 4
##    Container Treatment    FL treat        
##        &lt;int&gt; &lt;fct&gt;     &lt;dbl&gt; &lt;fct&gt;        
##  1         1 3          22.5 Two predators
##  2         1 3          20.6 Two predators
##  3         1 3          23.1 Two predators
##  4         1 3          23.7 Two predators
##  5         1 3          24.4 Two predators
##  6         1 3          23.6 Two predators
##  7         1 3          20.1 Two predators
##  8         1 3          23   Two predators
##  9         1 3          23.4 Two predators
## 10         1 3          25.0 Two predators
## # … with 224 more rows</code></pre>
<pre class="r"><code>snail.lmer &lt;- lmer(FL ~ treat + (1|Container), snail)</code></pre>
<pre class="r"><code>summary(snail.lmer)</code></pre>
<pre><code>## Linear mixed model fit by REML [&#39;lmerMod&#39;]
## Formula: FL ~ treat + (1 | Container)
##    Data: snail
## 
## REML criterion at convergence: 1163.4
## 
## Scaled residuals: 
##      Min       1Q   Median       3Q      Max 
## -2.62147 -0.68438  0.04799  0.62360  2.93899 
## 
## Random effects:
##  Groups    Name        Variance Std.Dev.
##  Container (Intercept) 0.6509   0.8068  
##  Residual              8.2124   2.8657  
## Number of obs: 234, groups:  Container, 12
## 
## Fixed effects:
##                      Estimate Std. Error t value
## (Intercept)           23.7426     0.5178  45.857
## treatSingle predator  -2.2159     0.7295  -3.037
## treatTwo predators    -1.8844     0.7353  -2.563
## 
## Correlation of Fixed Effects:
##             (Intr) trtSnp
## trtSnglprdt -0.710       
## trtTwprdtrs -0.704  0.500</code></pre>
<pre class="r"><code>plot(snail.lmer)</code></pre>
<p><img
src="11_LM_Extensions_files/figure-html/unnamed-chunk-6-1.png" /><!-- --></p>
<pre class="r"><code>check_mixed_model &lt;- function (model, model_name = NULL) {
  #collection of things you might check for mixed model
  par(mfrow = c(2,3))
  #not sure what this does with mutliple random effects, so stop with 1 for now
  if(length(names(ranef(model))&lt;2)){
    qqnorm(ranef(model, drop = T)[[1]], pch = 19, las = 1, cex = 1.4, main= paste(model_name, 
                                                                                  &quot;\n Random effects Q-Q plot&quot;))
  }
  plot(fitted(model),residuals(model), main = paste(model_name, 
                                                    &quot;\n residuals vs fitted&quot;))
  qqnorm(residuals(model), main =paste(model_name, 
                                       &quot;\nresiduals q-q plot&quot;))
  qqline(residuals(model))
  hist(residuals(model), main = paste(model_name, 
                                      &quot;\nresidual histogram&quot;))
}</code></pre>
<pre class="r"><code>check_mixed_model(snail.lmer)</code></pre>
<p><img
src="11_LM_Extensions_files/figure-html/unnamed-chunk-8-1.png" /><!-- --></p>
<pre class="r"><code>Anova(snail.lmer, type = &quot;III&quot;)</code></pre>
<pre><code>## Analysis of Deviance Table (Type III Wald chisquare tests)
## 
## Response: FL
##                Chisq Df Pr(&gt;Chisq)    
## (Intercept) 2102.876  1  &lt; 2.2e-16 ***
## treat         10.681  2   0.004792 ** 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<pre class="r"><code>snail_comparison &lt;- glht(snail.lmer, linfct = mcp(treat = &quot;Tukey&quot;))</code></pre>
<pre class="r"><code>summary(snail_comparison)</code></pre>
<pre><code>## 
##   Simultaneous Tests for General Linear Hypotheses
## 
## Multiple Comparisons of Means: Tukey Contrasts
## 
## 
## Fit: lmer(formula = FL ~ treat + (1 | Container), data = snail)
## 
## Linear Hypotheses:
##                                      Estimate Std. Error z value Pr(&gt;|z|)   
## Single predator - Control == 0        -2.2159     0.7295  -3.037  0.00656 **
## Two predators - Control == 0          -1.8844     0.7353  -2.563  0.02797 * 
## Two predators - Single predator == 0   0.3315     0.7326   0.453  0.89329   
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## (Adjusted p values reported -- single-step method)</code></pre>
<pre class="r"><code>#graph using Rmisc
snail_summary &lt;- summarySE(snail, measurevar = &quot;FL&quot;, groupvars = &quot;treat&quot;)</code></pre>
<pre class="r"><code>snail_summary</code></pre>
<pre><code>##             treat  N       FL       sd        se        ci
## 1         Control 78 23.73885 3.032709 0.3433867 0.6837703
## 2 Single predator 81 21.52432 2.943979 0.3271087 0.6509671
## 3   Two predators 75 21.86000 2.870529 0.3314601 0.6604487</code></pre>
<pre class="r"><code>snail.barplot &lt;- ggplot(snail_summary, aes(x = treat, y = FL)) +   
  geom_bar(stat = &quot;identity&quot;, width = 0.75, color = &quot;#2b2b2b&quot;, linewidth = 0.50, alpha = 0.6) +
  geom_linerange(aes(ymin = FL - ci, ymax = FL + ci), linewidth = 0.75) +
  #ylab(expression(paste(&quot;Gas (1000 &quot;,ft^3, &quot;)&quot;)))+
  xlab(&quot;Treatment&quot;) +
  #geom_smooth(method = &quot;lm&quot;, se = F) +
#  scale_y_continuous(expression(paste(&quot;Temperature&quot;)), limits = c(0, 10)) + 
#  scale_x_discrete(expand = c(0, 1)
                   #, 
                   #labels = x_labels
#                   ) + 
#  scale_fill_manual(breaks = c(&quot;North&quot;, &quot;West&quot;,
#                               &quot;Southeast&quot;),
#                    values = c(&quot;red&quot;, &quot;blue&quot;, 
#                               &quot;green&quot;), 
#                    labels = c(&quot;North&quot;, &quot;West&quot;,
#                               &quot;Southeast&quot;)) +
#  facet_wrap( ~ Insulate, labeller = as_labeller(label_names), dir = &quot;v&quot;, ncol = 1) + 
  ggtitle(expression(paste(italic(&quot; Response Varibale: FL&quot;)))) +
  #scale_y_log10(expression(paste(&quot;Colony Size (&quot;, cm^2, &quot;)&quot;), limits = c(0, 100000))) +
  labs(x = NULL) +
  theme(#strip.text = element_text(size = 10, color = &quot;black&quot;, hjust = 0.50),
        #strip.background = element_rect(fill = &quot;#FFFFFF&quot;, color = NA),    
        #panel.background = element_rect(fill = &quot;#FFFFFF&quot;, color = NA),
        #panel.grid.major.x = element_blank(),
        #panel.grid.minor.x = element_blank(),
        #panel.grid.minor.y = element_blank(),
        #panel.grid.major.y = element_line(color = &quot;#b2b2b2&quot;),
        #panel.spacing.x = unit(1, &quot;cm&quot;),
        #panel.spacing.y = unit(0.5, &quot;cm&quot;),
        #panel.spacing = unit(1, &quot;lines&quot;),
        axis.ticks = element_blank(),
        #legend.position = &quot;top&quot;,
        plot.title = element_text(size = 11),
        axis.title.y = element_text(size = 11),
        legend.title = element_blank()
        )</code></pre>
<pre class="r"><code>snail.barplot</code></pre>
<p><img
src="11_LM_Extensions_files/figure-html/unnamed-chunk-15-1.png" /><!-- --></p>
<p><strong>Conclusion</strong></p>
<p><em>Since multiple oysters were measured in each cage, we need to use
a random effect to account for cages. You could also block by cages- it
takes up more degrees of freedom, but you have plenty here. Results show
a significant differce among treatments (Chi^2~2=10.681, p &lt;.01), so
I used a Tukey post hoc test to determine which groups differed from
others while controlling for the family wise error rate. REsults
indicate the presence of a predator impacts length but not the
density.</em></p>
<ol start="2" style="list-style-type: decimal">
<li>(From OZDasl) The data give the ambient temperature and the number
of primary O-rings damaged for 23 of the 24 space shuttle launches
before the launch of the space shuttle Challenger on January 20, 1986.
(Challenger was the 25th shuttle. One engine was lost at sea and could
not be examined.) Each space shuttle contains 6 primary O-rings.</li>
</ol>
<p>Note these are counts. We can analyze this data using a Poisson
distribution or binomial. Make sure you understand why each one is
possible, which one is better, and carry out the analysis. Data is
available @</p>
<p><a href="http://www.statsci.org/data/general/challenger.txt"
class="uri">http://www.statsci.org/data/general/challenger.txt</a></p>
<pre class="r"><code>rings &lt;- read.table(&quot;http://www.statsci.org/data/general/challenger.txt&quot;, 
                    header = T)</code></pre>
<pre class="r"><code>rings</code></pre>
<pre><code>##    Temp Damaged
## 1    53       2
## 2    57       1
## 3    58       1
## 4    63       1
## 5    66       0
## 6    67       0
## 7    67       0
## 8    67       0
## 9    68       0
## 10   69       0
## 11   70       0
## 12   70       0
## 13   70       1
## 14   70       1
## 15   72       0
## 16   73       0
## 17   75       0
## 18   75       2
## 19   76       0
## 20   76       0
## 21   78       0
## 22   79       0
## 23   81       0</code></pre>
<pre class="r"><code>challenger &lt;- read.csv(file = &quot;challenger.csv&quot;) %&gt;%
as_tibble() 
#%&gt;%
#  mutate_at(vars(Treatment), factor) %&gt;%
#    mutate(treat = case_when(
#    Treatment == &quot;1&quot; ~ &quot;Control&quot;, 
#    Treatment == &quot;2&quot; ~ &quot;Single predator&quot;,
#    Treatment == &quot;3&quot; ~ &quot;Two predators&quot;
#  )
#    ) %&gt;%
#    mutate_at(vars(treat), factor)</code></pre>
<pre class="r"><code>challenger</code></pre>
<pre><code>## # A tibble: 23 × 2
##     Temp Damaged
##    &lt;int&gt;   &lt;int&gt;
##  1    53       2
##  2    57       1
##  3    58       1
##  4    63       1
##  5    66       0
##  6    67       0
##  7    67       0
##  8    67       0
##  9    68       0
## 10    69       0
## # … with 13 more rows</code></pre>
<pre class="r"><code># Poisson with whole numbers, i.e., counts
challenger.glm1 &lt;- glm(Damaged ~ Temp, family = &quot;poisson&quot;, data = challenger)</code></pre>
<pre class="r"><code>par(mfrow = c(2, 2))
plot(challenger.glm1)</code></pre>
<p><img
src="11_LM_Extensions_files/figure-html/unnamed-chunk-21-1.png" /><!-- --></p>
<pre class="r"><code>summary(challenger.glm1)</code></pre>
<pre><code>## 
## Call:
## glm(formula = Damaged ~ Temp, family = &quot;poisson&quot;, data = challenger)
## 
## Deviance Residuals: 
##      Min        1Q    Median        3Q       Max  
## -0.92135  -0.76907  -0.54934  -0.02268   2.50169  
## 
## Coefficients:
##             Estimate Std. Error z value Pr(&gt;|z|)  
## (Intercept)   5.9691     2.7628   2.161   0.0307 *
## Temp         -0.1034     0.0430  -2.405   0.0162 *
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for poisson family taken to be 1)
## 
##     Null deviance: 22.434  on 22  degrees of freedom
## Residual deviance: 16.834  on 21  degrees of freedom
## AIC: 36.061
## 
## Number of Fisher Scoring iterations: 6</code></pre>
<p><strong>Note</strong>: Dispersion is ok!!</p>
<pre class="r"><code>Anova(challenger.glm1, type = &quot;III&quot;)</code></pre>
<pre><code>## Analysis of Deviance Table (Type III tests)
## 
## Response: Damaged
##      LR Chisq Df Pr(&gt;Chisq)  
## Temp   5.6004  1    0.01796 *
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p><em>Try Binomial -&gt; proportion of successes:failures &lt;- number
damaged and not!</em></p>
<pre class="r"><code>challenger2 &lt;-
  challenger %&gt;%
  mutate(
    No_damage = 6 - Damaged)</code></pre>
<pre class="r"><code>challenger2</code></pre>
<pre><code>## # A tibble: 23 × 3
##     Temp Damaged No_damage
##    &lt;int&gt;   &lt;int&gt;     &lt;dbl&gt;
##  1    53       2         4
##  2    57       1         5
##  3    58       1         5
##  4    63       1         5
##  5    66       0         6
##  6    67       0         6
##  7    67       0         6
##  8    67       0         6
##  9    68       0         6
## 10    69       0         6
## # … with 13 more rows</code></pre>
<pre class="r"><code>challenger.glm2 &lt;- glm(cbind(Damaged, No_damage) ~ Temp, family = &quot;binomial&quot;, data = challenger2)</code></pre>
<pre class="r"><code>par(mfrow = c(2, 2))
plot(challenger.glm2)</code></pre>
<p><img
src="11_LM_Extensions_files/figure-html/unnamed-chunk-27-1.png" /><!-- --></p>
<pre class="r"><code>Anova(challenger.glm2, type = &quot;III&quot;)</code></pre>
<pre><code>## Analysis of Deviance Table (Type III tests)
## 
## Response: cbind(Damaged, No_damage)
##      LR Chisq Df Pr(&gt;Chisq)  
## Temp    6.144  1    0.01319 *
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p><strong>Compare to</strong> <em>lm</em></p>
<pre class="r"><code>challenger.lm &lt;- lm(Damaged ~ Temp, data = challenger2)</code></pre>
<pre class="r"><code>par(mfrow = c(2, 2))
plot(challenger.lm)</code></pre>
<p><img
src="11_LM_Extensions_files/figure-html/unnamed-chunk-30-1.png" /><!-- --></p>
<pre class="r"><code>summary(challenger.lm)</code></pre>
<pre><code>## 
## Call:
## lm(formula = Damaged ~ Temp, data = challenger2)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -0.5608 -0.3944 -0.0854  0.1056  1.8671 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)   
## (Intercept)  3.69841    1.21951   3.033  0.00633 **
## Temp        -0.04754    0.01744  -2.725  0.01268 * 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.5774 on 21 degrees of freedom
## Multiple R-squared:  0.2613, Adjusted R-squared:  0.2261 
## F-statistic: 7.426 on 1 and 21 DF,  p-value: 0.01268</code></pre>
<p><strong>Note</strong>: Dispersion is ok!!</p>
<pre class="r"><code>Anova(challenger.lm, type = &quot;III&quot;)</code></pre>
<pre><code>## Anova Table (Type III tests)
## 
## Response: Damaged
##             Sum Sq Df F value  Pr(&gt;F)   
## (Intercept) 3.0667  1  9.1973 0.00633 **
## Temp        2.4762  1  7.4264 0.01268 * 
## Residuals   7.0021 21                   
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p><em>Since these are counts we need to use a glm to model the data. We
could use a Poisson, but the binomial actually includes more information
(like how many did not fail!). Both models indicate a significant
relationship between temperature and the number or proportion of failed
rings. Results are compared to a linear model.</em></p>
<ol start="3" style="list-style-type: decimal">
<li>Returning to the whelk length-mass relationship from class, try
fitting an exponential curve to the data. As a hint, try</li>
</ol>
<pre class="r"><code>nls(Mass ~ exp(b0 + b1 * Shell.Length), whelk, 
                   start = list(b0 =1, b1=0), na.action = na.omit)</code></pre>
<p>Compare this model to those that assume a linear and power
relationship. Data is available @</p>
<p><a
href="https://raw.githubusercontent.com/jsgosnell/CUNY-BioStats/master/datasets/whelk.csv"
class="uri">https://raw.githubusercontent.com/jsgosnell/CUNY-BioStats/master/datasets/whelk.csv</a></p>
<pre class="r"><code>whelk &lt;- read.csv(file = &quot;whelk.csv&quot;) %&gt;%
as_tibble() %&gt;%
  mutate_at(vars(Location, Sex), factor) %&gt;%
  mutate_at(vars(Mass, Shell.Length), as.numeric)</code></pre>
<pre><code>## Warning in mask$eval_all_mutate(quo): NAs introduced by coercion

## Warning in mask$eval_all_mutate(quo): NAs introduced by coercion</code></pre>
<pre class="r"><code>#    mutate(treat = case_when(
#    Treatment == &quot;1&quot; ~ &quot;Control&quot;, 
#    Treatment == &quot;2&quot; ~ &quot;Single predator&quot;,
#    Treatment == &quot;3&quot; ~ &quot;Two predators&quot;
#  )
#    ) %&gt;%
#    mutate_at(vars(treat), factor)</code></pre>
<pre class="r"><code>whelk</code></pre>
<pre><code>## # A tibble: 473 × 4
##    Location  Mass Sex   Shell.Length
##    &lt;fct&gt;    &lt;dbl&gt; &lt;fct&gt;        &lt;dbl&gt;
##  1 sd       126.  F             NA  
##  2 sd       120.  M            106. 
##  3 sd        40.1 M             75.6
##  4 sd       141.  F            108. 
##  5 sd        49.7 M             76.2
##  6 sd        NA   M             70.1
##  7 sd        NA   F             80.1
##  8 sd        NA   M             66.4
##  9 sd        NA   F            106. 
## 10 sd        NA   F             93.1
## # … with 463 more rows</code></pre>
<pre class="r"><code>whelk.reg &lt;- ggplot(data = whelk, aes(x = Shell.Length, y = Mass, color = Location)) +   
  geom_point(size = 2, alpha = 0.6) +
#  ylim (0.0, 1.0) +
  ggtitle(expression(paste(italic(&quot; Whelk&quot;)))) +
#  xlab(expression(paste(&quot;Mean Wave Height (m)&quot;))) + 
#  ylab(expression(paste(&quot;Benthic Coverage&quot;))) +
#  annotate(
#    &quot;text&quot;,
#    x = Inf, y = -Inf,
#    label = eqn_plob, parse = TRUE,
#    hjust = 1.1, vjust = -.5
#  ) +
  theme_bw() + 
#  facet_wrap( ~ type,  ncol = 3) +
  theme(#panel.spacing = unit(1, &quot;lines&quot;),
        legend.position = &quot;right&quot;,
        plot.title = element_text(size = 11),
        legend.title = element_blank()) 
#+
 # stat_smooth(method = &quot;lm&quot;, se = FALSE, color = &quot;black&quot;)</code></pre>
<pre class="r"><code>whelk.reg</code></pre>
<pre><code>## Warning: Removed 61 rows containing missing values
## (`geom_point()`).</code></pre>
<p><img
src="11_LM_Extensions_files/figure-html/unnamed-chunk-37-1.png" /><!-- --></p>
<pre class="r"><code>whelk_plot &lt;- ggplot(whelk, aes_string(x=&quot;Shell.Length&quot;, y = &quot;Mass&quot;)) +
  geom_point(aes_string(colour = &quot;Location&quot;)) + 
  theme(axis.title.x = element_text(face=&quot;bold&quot;, size=28), 
        axis.title.y = element_text(face=&quot;bold&quot;, size=28), 
        axis.text.y  = element_text(size=20),
        axis.text.x  = element_text(size=20), 
        legend.text =element_text(size=20),
        legend.title = element_text(size=20, face=&quot;bold&quot;),
        plot.title = element_text(hjust = 0.5, face=&quot;bold&quot;, size=32))</code></pre>
<pre><code>## Warning: `aes_string()` was deprecated in ggplot2
## 3.0.0.
## ℹ Please use tidy evaluation ideoms with
##   `aes()`</code></pre>
<pre class="r"><code>whelk_plot</code></pre>
<pre><code>## Warning: Removed 61 rows containing missing values
## (`geom_point()`).</code></pre>
<p><img
src="11_LM_Extensions_files/figure-html/unnamed-chunk-39-1.png" /><!-- --></p>
<p><em>Power fit</em></p>
<pre class="r"><code>whelk.lm &lt;- lm(Mass ~ Shell.Length, whelk, na.action = na.omit)</code></pre>
<pre class="r"><code>whelk.power &lt;- nls(Mass ~ b0 * Shell.Length^b1, whelk, 
                   start = list(b0 = 1, b1 = 3), na.action = na.omit)</code></pre>
<pre class="r"><code>whelk.exponential &lt;- nls(Mass ~ exp(b0 + b1 * Shell.Length), whelk, 
                         start = list(b0 = 1, b1 = 0), na.action = na.omit)</code></pre>
<pre class="r"><code>AICc(whelk.lm, whelk.power, whelk.exponential)</code></pre>
<pre><code>##                   df     AICc
## whelk.lm           3 3947.579
## whelk.power        3 3800.106
## whelk.exponential  3 3841.422</code></pre>
<p><strong>Now, plot!</strong></p>
<pre class="r"><code>whelk_plot + 
  
  geom_smooth(method = &quot;lm&quot;, se = FALSE, linewidth = 1.5, color = &quot;orange&quot;) + 
  
  geom_smooth(method = &quot;nls&quot;, 
              # look at whelk_power$call
              formula = y ~ b0 * x^b1, 
              method.args = list(start = list(b0 = 1, 
                                              b1 = 3)), 
              se = FALSE, linewidth = 1.5, color = &quot;blue&quot;) +
  geom_smooth(method = &quot;nls&quot;, 
              # look at whelk_exponential$call
              formula = y ~ exp(b0 + b1 * x), 
              method.args = list(start = list(b0 = 1, 
                                              b1 = 0)), 
              se = FALSE, linewidth = 1.5, color = &quot;green&quot;)</code></pre>
<pre><code>## `geom_smooth()` using formula = &#39;y ~ x&#39;</code></pre>
<pre><code>## Warning: Removed 61 rows containing non-finite values
## (`stat_smooth()`).
## Removed 61 rows containing non-finite values
## (`stat_smooth()`).
## Removed 61 rows containing non-finite values
## (`stat_smooth()`).</code></pre>
<pre><code>## Warning: Removed 61 rows containing missing values
## (`geom_point()`).</code></pre>
<p><img
src="11_LM_Extensions_files/figure-html/unnamed-chunk-44-1.png" /><!-- --></p>
<p><em>We can use the nls model to consider exponential curve to the
data. Various fits may be compared using AIC methods. In this case it
appears that the power fit is the best (lowest AIC value).</em></p>
<ol start="4" style="list-style-type: decimal">
<li>Going back to the TEAM dataset, remember we found that elevation had
no impact on carbon storage. But that was a linear fit. Use a gam
(generalized additive model) to see if elevation can be related to
carbon storage in an additive model. Note we can use the gamm
(generalized additive mixed model) function in the mgcv package to
denote mixed effects. For example (from help file)</li>
</ol>
<pre class="r"><code>b2 &lt;- gamm(y ~ s(x0) + s(x1) + s(x2) , family = poisson,
           data = dat, random = list(fac = ~1))</code></pre>
<p>Team data is available @</p>
<p><a
href="https://github.com/jsgosnell/CUNY-BioStats/blob/master/datasets/team_data_no_spaces.csv"
class="uri">https://github.com/jsgosnell/CUNY-BioStats/blob/master/datasets/team_data_no_spaces.csv</a></p>
<pre class="r"><code>team &lt;- read.csv(&quot;https://raw.githubusercontent.com/jsgosnell/CUNY-BioStats/master/datasets/team_data_no_spaces.csv&quot;, stringsAsFactors = T)</code></pre>
<pre class="r"><code>team</code></pre>
<pre><code>##    Plot.Number Sampling.Period
## 1     VG-BBS-1         2010.01
## 2     VG-BBS-2         2010.01
## 3     VG-BBS-3         2010.01
## 4     VG-BBS-4         2010.01
## 5     VG-BBS-5         2010.01
## 6     VG-BBS-6         2010.01
## 7     VG-BCI-1         2010.01
## 8     VG-BCI-3         2010.01
## 9     VG-BCI-4         2010.01
## 10    VG-BCI-5         2010.01
## 11    VG-BCI-6         2010.01
## 12    VG-BIF-1         2011.01
## 13    VG-BIF-2         2011.01
## 14    VG-BIF-3         2011.01
## 15    VG-BIF-4         2011.01
## 16    VG-BIF-5         2011.01
## 17    VG-BIF-6         2011.01
## 18    VG-CAX-1         2010.01
## 19    VG-CAX-2         2010.01
## 20    VG-CAX-3         2010.01
## 21    VG-CAX-4         2010.01
## 22    VG-CAX-5         2010.01
## 23    VG-CAX-6         2010.01
## 24    VG-MAS-1         2011.01
## 25    VG-MAS-2         2011.01
## 26    VG-MAS-3         2011.01
## 27    VG-MAS-4         2011.01
## 28    VG-MAS-5         2011.01
## 29    VG-MAS-6         2011.01
## 30    VG-NNN-1         2010.01
## 31    VG-NNN-2         2010.01
## 32    VG-PSH-1         2012.01
## 33    VG-PSH-2         2012.01
## 34    VG-PSH-3         2012.01
## 35    VG-PSH-4         2012.01
## 36    VG-PSH-5         2012.01
## 37    VG-PSH-6         2012.01
## 38    VG-RNF-1         2011.01
## 39    VG-RNF-2         2011.01
## 40    VG-RNF-3         2011.01
## 41    VG-RNF-4         2011.01
## 42    VG-RNF-5         2011.01
## 43    VG-RNF-6         2011.01
## 44    VG-UDZ-1         2011.01
## 45    VG-UDZ-2         2011.01
## 46    VG-UDZ-3         2011.01
## 47    VG-UDZ-4         2011.01
## 48    VG-UDZ-5         2011.01
## 49    VG-UDZ-6         2011.01
## 50     VG-VB-1         2011.01
## 51     VG-VB-2         2011.01
## 52     VG-VB-3         2011.01
## 53     VG-VB-4         2011.01
## 54     VG-VB-5         2011.01
## 55     VG-VB-7         2011.01
## 56     VG-VB-8         2011.01
## 57     VG-VB-9         2011.01
## 58    VG-YAN-5         2011.01
##                                                   Site.Name
## 1                                             Bukit Barisan
## 2                                             Bukit Barisan
## 3                                             Bukit Barisan
## 4                                             Bukit Barisan
## 5                                             Bukit Barisan
## 6                                             Bukit Barisan
## 7  Barro Colorado Nature Monument - Soberania National Park
## 8  Barro Colorado Nature Monument - Soberania National Park
## 9  Barro Colorado Nature Monument - Soberania National Park
## 10 Barro Colorado Nature Monument - Soberania National Park
## 11 Barro Colorado Nature Monument - Soberania National Park
## 12                               Bwindi Impenetrable Forest
## 13                               Bwindi Impenetrable Forest
## 14                               Bwindi Impenetrable Forest
## 15                               Bwindi Impenetrable Forest
## 16                               Bwindi Impenetrable Forest
## 17                               Bwindi Impenetrable Forest
## 18                                              Caxiuan\xe3
## 19                                              Caxiuan\xe3
## 20                                              Caxiuan\xe3
## 21                                              Caxiuan\xe3
## 22                                              Caxiuan\xe3
## 23                                              Caxiuan\xe3
## 24                                                   Manaus
## 25                                                   Manaus
## 26                                                   Manaus
## 27                                                   Manaus
## 28                                                   Manaus
## 29                                                   Manaus
## 30                                        Nouabal\xe9 Ndoki
## 31                                        Nouabal\xe9 Ndoki
## 32                                     Pasoh Forest Reserve
## 33                                     Pasoh Forest Reserve
## 34                                     Pasoh Forest Reserve
## 35                                     Pasoh Forest Reserve
## 36                                     Pasoh Forest Reserve
## 37                                     Pasoh Forest Reserve
## 38                                               Ranomafana
## 39                                               Ranomafana
## 40                                               Ranomafana
## 41                                               Ranomafana
## 42                                               Ranomafana
## 43                                               Ranomafana
## 44                                                 Udzungwa
## 45                                                 Udzungwa
## 46                                                 Udzungwa
## 47                                                 Udzungwa
## 48                                                 Udzungwa
## 49                                                 Udzungwa
## 50                                          Volc\xe1n Barva
## 51                                          Volc\xe1n Barva
## 52                                          Volc\xe1n Barva
## 53                                          Volc\xe1n Barva
## 54                                          Volc\xe1n Barva
## 55                                          Volc\xe1n Barva
## 56                                          Volc\xe1n Barva
## 57                                          Volc\xe1n Barva
## 58                     Yanachaga Chimill\xe9n National Park
##    Number.of.Tree.Family Number.of.Tree.Genus Number.of.Trees.counted  shannon
## 1                     32                   59                     489 2.763055
## 2                     40                   80                     426 3.683108
## 3                     37                   69                     371 3.593169
## 4                     37                   78                     447 3.523640
## 5                     34                   54                     224 3.441493
## 6                     34                   60                     427 3.101320
## 7                     37                   74                     441 3.455152
## 8                     39                   76                     591 3.602975
## 9                     38                   81                     566 3.596799
## 10                    38                   75                     523 3.411104
## 11                    34                   62                     482 3.039393
## 12                    30                   40                     559 2.854763
## 13                    21                   29                     382 2.222974
## 14                    31                   37                     602 3.099656
## 15                    26                   28                     684 2.071038
## 16                    24                   29                     299 2.544058
## 17                    20                   23                     636 1.905052
## 18                    30                   76                     523 3.057508
## 19                    35                   96                     511 3.654942
## 20                    35                   87                     419 3.323010
## 21                    33                   93                     479 3.645199
## 22                    39                   97                     512 3.801410
## 23                    35                   87                     468 3.562312
## 24                    46                  133                     647 4.144301
## 25                    44                  126                     639 4.118254
## 26                    46                  126                     704 3.908297
## 27                    40                  124                     648 4.115669
## 28                    47                  138                     723 4.086648
## 29                    45                  123                     741 3.928402
## 30                    26                   49                     253 3.198674
## 31                    26                   42                     295 2.960496
## 32                    44                  104                     665 3.806534
## 33                    42                  104                     435 3.920862
## 34                    31                   62                     339 3.498709
## 35                    46                   97                     371 4.114831
## 36                    39                   80                     382 3.898860
## 37                    35                   70                     307 3.460613
## 38                    36                   59                     742 3.268024
## 39                    44                   76                    1033 3.652777
## 40                    41                   63                    1413 2.942562
## 41                    36                   59                     957 3.194197
## 42                    37                   52                    1270 2.914130
## 43                    41                   73                    1075 3.649949
## 44                    22                   32                     453 2.076799
## 45                    26                   40                     543 2.954741
## 46                    15                   20                     468 1.494541
## 47                    35                   46                     700 3.122810
## 48                    19                   22                     471 1.679690
## 49                    25                   36                     582 2.781866
## 50                    40                   73                     477 3.429365
## 51                    36                   74                     503 3.658959
## 52                    49                  108                     649 4.108726
## 53                    51                   99                     689 3.882451
## 54                    34                   43                     536 3.047909
## 55                    32                   53                     429 3.383373
## 56                    30                   43                     405 3.053130
## 57                    44                   74                     390 3.552203
## 58                    46                   89                     718 3.632618
##      wd.RaoQ maxdbh.RaoQ    CWM.wd CWM.maxdbh        PD PlotBiomass.kg
## 1  1.2733049  0.06075746 0.5163594   52.91667  6803.813      208276.73
## 2  0.7043037  0.04497199 0.5738343   46.49707  8881.414      215965.15
## 3  1.2402253  0.05425123 0.5474627   52.20660  7957.517      223417.41
## 4  0.5556143  0.18827702 0.5956120   65.23635  8221.578      418867.80
## 5  0.8393656  0.10622086 0.5518887   55.64576  6323.870      136455.82
## 6  0.4470921  0.22320169 0.5842017   70.29356  7152.506      384264.25
## 7  0.7350526  0.08132172 0.6212790   42.39206  8384.451      285362.27
## 8  1.3624895  0.11388031 0.5303465   47.33181  8648.817      266261.74
## 9  1.6418393  0.10261697 0.5511378   44.89505  8503.733      386951.19
## 10 1.4860025  0.10310778 0.5444892   49.31052  8509.727      374763.58
## 11 0.5035533  0.14917876 0.6111499   44.56058  7145.060      272974.55
## 12 0.5125105  0.08357307 0.5807348   59.04436  5427.296      200216.21
## 13 1.1190501  0.07731648 0.5522001   65.64581  4975.063       77223.77
## 14 0.3561466  0.08831919 0.5391737   56.85980  5803.156      201722.01
## 15 0.2467773  0.16554836 0.5427673   78.68743  4560.519      339805.11
## 16 0.8932808  0.04680558 0.6059397   63.14047  4547.960      203638.66
## 17 0.6864026  0.05726251 0.4851762   64.27642  4330.643      205861.14
## 18 0.5093230  0.08516359 0.7532309   76.16501  8743.587      463357.06
## 19 0.6897588  0.08845907 0.7158428   65.35695  9889.883      546178.83
## 20 0.7108482  0.11169956 0.7184959   69.24033  9354.792      637007.56
## 21 0.7431085  0.11651704 0.6890617   61.17035  9550.404      478605.35
## 22 0.6603592  0.11771263 0.6913747   58.67637 10377.800      588733.32
## 23 0.6745564  0.09922661 0.7221453   69.69380  9415.312      395174.24
## 24 0.7017114  0.04382071 0.6884457   50.61793 12757.042      434644.86
## 25 0.6314652  0.04265087 0.6907798   50.43302 12675.817      393793.04
## 26 0.7773605  0.03854739 0.6920217   53.28153 12252.815      334585.00
## 27 0.9623153  0.03888989 0.6230809   48.27901 11814.633      293915.24
## 28 0.7749345  0.04231000 0.6884804   51.52185 12925.018      320453.57
## 29 0.7734384  0.04161728 0.6632104   51.81430 11743.038      304829.96
## 30 0.8211310  0.08784172 0.6692456   88.77312  6187.436      416711.42
## 31 0.6933094  0.15773942 0.6655444   93.94712  5576.137      426991.35
## 32 0.4461225  0.11392871 0.6092211   59.51353 10962.081      256772.88
## 33 0.5618353  0.09405911 0.5512760   55.74069 11068.620      272452.73
## 34 1.5830805  0.07547842 0.5214491   58.81209  6853.574      344548.66
## 35 0.6971841  0.07964851 0.5724404   54.83720 10900.493      270114.14
## 36 0.6496232  0.07413429 0.5967936   56.84791  9264.852      279249.33
## 37 1.1997936  0.06324587 0.5250496   48.31564  8463.863       83791.94
## 38 0.4642010  0.17216624 0.5805853   91.60876  7069.224      554302.37
## 39 0.6344096  0.17257985 0.6040364   71.96128  8725.963      542541.56
## 40 0.3423083  0.07637027 0.6162635   62.25407  8023.723      358169.87
## 41 0.4900557  0.09955398 0.6249986   62.98798  7182.949      326575.35
## 42 0.4556776  0.11536879 0.6092041   69.18835  6615.734      273698.47
## 43 0.5111704  0.13160100 0.5838349   69.08902  8147.533      407615.15
## 44 0.5640388  0.06816474 0.6803608   87.63819  4797.600      251795.25
## 45 0.3797582  0.09409027 0.6282077   78.22910  5471.103      318385.15
## 46 0.3042216  0.05519637 0.5784080   76.48056  3003.288      259151.96
## 47 0.3424428  0.17238183 0.6596272   71.50543  6638.164      324590.36
## 48 1.0341331  0.30252851 0.5706824   87.81932  3349.470      174391.23
## 49 0.3003411  0.11920223 0.6478866   76.04708  5019.677      323471.37
## 50 1.4512014  0.10593410 0.5013986   52.32390  8445.565      253173.79
## 51 1.1035292  0.08919109 0.5555873   56.00656  8165.363      299607.47
## 52 0.8885677  0.04488616 0.5992401   51.09353 11021.308      305673.49
## 53 0.8396401  0.04532807 0.5931934   49.33251 11369.507      295887.99
## 54 0.4918757  0.09765475 0.5149468   55.77201  6003.131      276601.20
## 55 0.6658289  0.05315290 0.5553281   47.21235  6601.088      194031.57
## 56 0.7459224  0.05197640 0.5594048   48.33407  5818.731      253993.98
## 57 1.1754908  0.12360942 0.5224951   56.79282  8799.583      299179.90
## 58 0.8404467  0.02800657 0.5600128   36.03663  9591.564      205789.22
##    PlotCarbon.tonnes Reserve_size.sqkm     Continent    Country Precip_mean.mm
## 1             114.55              3560          Asia  Indonesia       2871.333
## 2             118.78              3560          Asia  Indonesia       2871.333
## 3             122.88              3560          Asia  Indonesia       2871.333
## 4             230.38              3560          Asia  Indonesia       2871.333
## 5              75.05              3560          Asia  Indonesia       2871.333
## 6             211.35              3560          Asia  Indonesia       2871.333
## 7             156.95               274 Latin_America     Panama       2420.000
## 8             146.44               274 Latin_America     Panama       2420.000
## 9             212.82               274 Latin_America     Panama       2420.000
## 10            206.12               274 Latin_America     Panama       2420.000
## 11            150.14               274 Latin_America     Panama       2420.000
## 12            110.12               331        Africa     Uganda       1239.000
## 13             42.47               331        Africa     Uganda       1239.000
## 14            110.95               331        Africa     Uganda       1239.000
## 15            186.89               331        Africa     Uganda       1239.000
## 16            112.00               331        Africa     Uganda       1239.000
## 17            113.22               331        Africa     Uganda       1239.000
## 18            254.85               330 Latin_America     Brazil       2342.000
## 19            300.40               330 Latin_America     Brazil       2342.000
## 20            350.35               330 Latin_America     Brazil       2342.000
## 21            263.23               330 Latin_America     Brazil       2342.000
## 22            323.80               330 Latin_America     Brazil       2342.000
## 23            217.35               330 Latin_America     Brazil       2342.000
## 24            239.05              2678 Latin_America     Brazil       2192.000
## 25            216.59              2678 Latin_America     Brazil       2192.000
## 26            184.02              2678 Latin_America     Brazil       2192.000
## 27            161.65              2678 Latin_America     Brazil       2192.000
## 28            176.25              2678 Latin_America     Brazil       2192.000
## 29            167.66              2678 Latin_America     Brazil       2192.000
## 30            229.19              4200        Africa      Congo       1662.200
## 31            234.85              4200        Africa      Congo       1662.200
## 32            141.23               140          Asia   Malaysia       2067.444
## 33            149.85               140          Asia   Malaysia       2067.444
## 34            189.50               140          Asia   Malaysia       2067.444
## 35            148.56               140          Asia   Malaysia       2067.444
## 36            153.59               140          Asia   Malaysia       2067.444
## 37             46.09               140          Asia   Malaysia       2067.444
## 38            304.87               416        Africa Madagascar       1553.000
## 39            298.40               416        Africa Madagascar       1553.000
## 40            196.99               416        Africa Madagascar       1553.000
## 41            179.62               416        Africa Madagascar       1553.000
## 42            150.53               416        Africa Madagascar       1553.000
## 43            224.19               416        Africa Madagascar       1553.000
## 44            138.49              1990        Africa   Tanzania       1370.889
## 45            175.11              1990        Africa   Tanzania       1370.889
## 46            142.53              1990        Africa   Tanzania       1370.889
## 47            178.52              1990        Africa   Tanzania       1370.889
## 48             95.92              1990        Africa   Tanzania       1370.889
## 49            177.91              1990        Africa   Tanzania       1370.889
## 50            139.25               492 Latin_America Costa Rica       3461.833
## 51            164.78               492 Latin_America Costa Rica       3461.833
## 52            168.12               492 Latin_America Costa Rica       3461.833
## 53            162.74               492 Latin_America Costa Rica       3461.833
## 54            152.13               492 Latin_America Costa Rica       3461.833
## 55            106.72               492 Latin_America Costa Rica       3461.833
## 56            139.70               492 Latin_America Costa Rica       3461.833
## 57            164.55               492 Latin_America Costa Rica       3461.833
## 58            113.18              1106 Latin_America       Peru       2197.316
##    Precip_CV Elevation Distance_to_forest_edge Latitude Longitude
## 1  0.1459985        56                     0.1   -5.250   104.167
## 2  0.1459985        22                     0.1   -5.250   104.167
## 3  0.1459985        31                     0.1   -5.250   104.167
## 4  0.1459985       197                     1.7   -5.250   104.167
## 5  0.1459985        66                     1.0   -5.250   104.167
## 6  0.1459985       166                     0.1   -5.250   104.167
## 7  0.6089139        58                     0.5    9.152   -79.846
## 8  0.6089139       156                     0.1    9.152   -79.846
## 9  0.6089139       189                     1.4    9.152   -79.846
## 10 0.6089139       170                     0.9    9.152   -79.846
## 11 0.6089139        68                     0.9    9.152   -79.846
## 12 0.3233659      1496                     0.6   -1.081    29.661
## 13 0.3233659      1417                     0.2   -1.081    29.661
## 14 0.3233659      1879                     1.0   -1.081    29.661
## 15 0.3233659      2050                     3.1   -1.081    29.661
## 16 0.3233659      2100                     1.7   -1.081    29.661
## 17 0.3233659      2338                     3.1   -1.081    29.661
## 18 0.5747651        44                     3.1   -1.729   -51.474
## 19 0.5747651        42                     1.7   -1.729   -51.474
## 20 0.5747651        53                     1.9   -1.729   -51.474
## 21 0.5747651        48                     1.7   -1.729   -51.474
## 22 0.5747651        49                     1.0   -1.729   -51.474
## 23 0.5747651        50                     2.2   -1.729   -51.474
## 24 0.4288914        81                     5.3   -2.929   -59.976
## 25 0.4288914       107                     3.5   -2.929   -59.976
## 26 0.4288914       128                     8.9   -2.929   -59.976
## 27 0.4288914       149                    19.8   -2.929   -59.976
## 28 0.4288914        77                    10.7   -2.929   -59.976
## 29 0.4288914       119                     7.8   -2.929   -59.976
## 30 0.4569364       470                    35.8       NA        NA
## 31 0.4569364       504                    32.7       NA        NA
## 32 0.2947727       391                     2.3    2.982   103.313
## 33 0.2947727       651                     0.1    2.982   103.313
## 34 0.2947727       792                     1.5    2.982   103.313
## 35 0.2947727       426                     0.1    2.982   103.313
## 36 0.2947727       419                     0.3    2.982   103.313
## 37 0.2947727       115                     1.4    2.982   103.313
## 38 0.6873826      1173                     2.7  -21.133    47.417
## 39 0.6873826      1147                     1.2  -21.133    47.417
## 40 0.6873826      1168                     2.5  -21.133    47.417
## 41 0.6873826      1159                     3.0  -21.133    47.417
## 42 0.6873826      1218                     4.3  -21.133    47.417
## 43 0.6873826      1053                     1.5  -21.133    47.417
## 44 0.9099537      1140                     0.7   -7.843    36.891
## 45 0.9099537      1856                     1.8   -7.843    36.891
## 46 0.9099537       715                     1.2   -7.843    36.891
## 47 0.9099537      1518                     2.6   -7.843    36.891
## 48 0.9099537      1558                     2.3   -7.843    36.891
## 49 0.9099537       911                     0.6   -7.843    36.891
## 50 0.3938946       106                     0.8   10.303   -84.034
## 51 0.3938946       174                     0.1   10.303   -84.034
## 52 0.3938946       576                     2.1   10.303   -84.034
## 53 0.3938946       406                     1.0   10.303   -84.034
## 54 0.3938946      1997                     2.8   10.303   -84.034
## 55 0.3938946       925                     5.0   10.303   -84.034
## 56 0.3938946      1447                     3.9   10.303   -84.034
## 57 0.3938946        68                     0.7   10.303   -84.034
## 58 0.4440274      1273                     0.7  -10.494   -75.201
##    Annual_Evapotranspiration
## 1                  141.56257
## 2                  141.56257
## 3                  141.56257
## 4                  141.56257
## 5                  141.56257
## 6                  141.56257
## 7                  121.55889
## 8                  121.55889
## 9                  121.55889
## 10                 121.55889
## 11                 121.55889
## 12                  88.35371
## 13                  88.35371
## 14                  88.35371
## 15                  88.35371
## 16                  88.35371
## 17                  88.35371
## 18                 157.01108
## 19                 157.01108
## 20                 157.01108
## 21                 157.01108
## 22                 157.01108
## 23                 157.01108
## 24                 132.45972
## 25                 132.45972
## 26                 132.45972
## 27                 132.45972
## 28                 132.45972
## 29                 132.45972
## 30                        NA
## 31                        NA
## 32                 117.03503
## 33                 117.03503
## 34                 117.03503
## 35                 117.03503
## 36                 117.03503
## 37                 117.03503
## 38                 139.06903
## 39                 139.06903
## 40                 139.06903
## 41                 139.06903
## 42                 139.06903
## 43                 139.06903
## 44                 100.38220
## 45                 100.38220
## 46                 100.38220
## 47                 100.38220
## 48                 100.38220
## 49                 100.38220
## 50                 160.96977
## 51                 160.96977
## 52                 160.96977
## 53                 160.96977
## 54                 160.96977
## 55                 160.96977
## 56                 160.96977
## 57                 160.96977
## 58                 130.70475</code></pre>
<pre class="r"><code>elevation_linear &lt;- gam(PlotCarbon.tonnes ~ Elevation, data = team)</code></pre>
<pre class="r"><code>elevation_gam &lt;- gam(PlotCarbon.tonnes ~ s(Elevation), data = team)</code></pre>
<pre class="r"><code>elevation_gamm &lt;- gamm(PlotCarbon.tonnes ~s(Elevation), random = list(Site.Name = ~ 1), data = team)</code></pre>
<pre class="r"><code>AICc(elevation_gam, elevation_gamm, elevation_linear)</code></pre>
<pre><code>##                  df     AICc
## elevation_gam     3 648.2139
## elevation_gamm    5 634.4652
## elevation_linear  3 648.2139</code></pre>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
